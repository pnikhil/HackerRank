SELECT DOCTOR,PROFESSOR,SINGER,ACTOR 
FROM
(	SELECT ROW_WISE,MAX(CASE WHEN occupation='Doctor' THEN NAME END) AS DOCTOR,
	MAX(CASE WHEN occupation='Professor' THEN NAME END) AS PROFESSOR,
	MAX(CASE WHEN occupation='Singer' THEN NAME END) AS SINGER,
	MAX(CASE WHEN occupation='Actor' THEN NAME END) AS ACTOR 
	FROM 
	(	
		SELECT ROW_NUMBER() OVER (PARTITION BY occupation ORDER BY NAME) AS ROW_WISE, name,occupation 
		FROM occupations
    ) ALIAS1 
	GROUP BY ROW_WISE
) ALIAS2 
ORDER BY DOCTOR,PROFESSOR,SINGER,ACTOR;
